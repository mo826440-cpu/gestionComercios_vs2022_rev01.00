@using Microsoft.AspNetCore.Components
@using Shared.Services
@inject IAuthService AuthService

@if (isAuthenticated)
{
    <RouteView RouteData="@routeData" DefaultLayout="@typeof(MainLayout)" />
    <FocusOnNavigate RouteData="@routeData" Selector="h1" />
}
else if (routeData?.PageType?.FullName?.Contains("Login") == true)
{
    <RouteView RouteData="@routeData" DefaultLayout="@typeof(MainLayout)" />
}
else
{
    <RedirectToLogin />
}

@code {
    [Parameter] public RouteData? routeData { get; set; }
    
    private bool isAuthenticated = false;
    private bool isLoading = true;

    protected override async Task OnInitializedAsync()
    {
        isAuthenticated = await AuthService.IsAuthenticatedAsync();
        isLoading = false;
        StateHasChanged();
    }
}
